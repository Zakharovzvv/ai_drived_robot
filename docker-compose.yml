version: "3.9"

services:
  backend:
    build:
      context: .
      dockerfile: docker/backend.Dockerfile
    env_file:
      - .env
    environment:
      OPERATOR_WIFI_CACHE_PATH: /app/state/last_wifi_endpoint.json
      OPERATOR_WS_ENDPOINT: ${OPERATOR_WS_ENDPOINT:-}
    ports:
      - "8110:8000"
    restart: unless-stopped
    volumes:
      - ./.state/backend:/app/state

  frontend:
    build:
      context: .
      dockerfile: docker/frontend.Dockerfile
    depends_on:
      - backend
    ports:
      - "5174:80"
    restart: unless-stopped
